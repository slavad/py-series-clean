#!/usr/bin/env python

import argparse
import py_series_clean.clean as pscc
import helpers.file_readers as fr
import helpers.argument_parsers as ap
import helpers.input_validators as iv

def parse_args():
    descr = 'Reads and analyzes file with time series'
    parser = argparse.ArgumentParser(description=descr)
    ap.parse_common_series_args(parser)
    parser.add_argument(
        '-t',
        required = True,
        help = 'detection treshold (aka X_q), see eq 48 and 152 in ref 2, can be esitmated using estimate_treshold script',
        metavar ='TRESHOLD',
        type = iv.check_positive_float
    )
    args = parser.parse_args()
    return args

def main():
    """entry point"""
    args = parse_args()
    time_grid_and_values = fr.read_file(args.i)
    pscc.clean(time_grid_and_values, args.k, args.t)

main()